#include <iostream>
#include <vector>
#include <fstream>
#include <sstream>
#include <string>
#include <cassert>

#define _USE_MATH_DEFINES
#include <cmath>

using namespace std;

bool extract_uint16_t(string line, uint16_t * ret)
{
    stringstream ss(line);
    unsigned int a = 0, b = 0;
    if(ss >> a >> b)
    {
        *ret = ((a & 0xFF) << 8) | (b & 0xFF);
        return true;
    }

    *ret = 0;
    return false;
}

vector<vector<uint16_t>> extract_tab_images(const char * filename)
{
    string line;
    ifstream file(filename);

    vector<vector<uint16_t>> tab_images;

    while(getline(file, line))
    {
        if(line.find("NEW_IMAGE:") != string::npos)
            tab_images.push_back(vector<uint16_t>());
        else
        {
            uint16_t val_uint16_t;
            if(extract_uint16_t(line, &val_uint16_t))
                tab_images[tab_images.size() - 1].push_back(val_uint16_t);
        }
    }
    cout << "Found " << tab_images.size() << " images" << endl;
    unsigned int img_size = tab_images[0].size();

    // same size for all images ?
    bool same_size_problem = false;
    for(size_t i = 1 ; i < tab_images.size() ; ++i)
    {
        if(tab_images[i].size() != img_size)
        {
            same_size_problem = true;
            break;
        }
    }
    if(same_size_problem)
    {
        cout << "There is a problem about the size of ours images" << endl;
        for(size_t i = 0 ; i < tab_images.size() ; ++i)
            cout << "Image " << i << ": size: " << tab_images[i].size() << endl;
    }
    else
        cout << "Size: " << img_size << endl;


    return tab_images;
}

// RRRRRGGG GGGBBBBB
uint8_t extract_red(uint16_t pattern)
{
    return (pattern >> 11) & 31;
}

uint8_t extract_green(uint16_t pattern)
{
    return (pattern >> 5) & 63;
}

uint8_t extract_blue(uint16_t pattern)
{
    return pattern & 31;
}

void convert_rgb_to_hsv(double & h, double & s, double & v, uint8_t r_int, uint8_t g_int, uint8_t b_int)
{
    // adapté de https://stackoverflow.com/questions/3018313/algorithm-to-convert-rgb-to-hsv-and-hsv-to-rgb-in-range-0-255-for-both
    // consulté le 27.04.2020
    // David H
    double min, max, delta;
    double r(r_int), g(g_int), b(b_int);
    r /= 31.;
    g /= 63.;
    b /= 31.;

    min = r < g ? r: g;
    min = min < b ? min: b;

    max = r > g ? r: g;
    max = max > b ? max: b;

    v = max;
    delta = max - min;

    if(delta < 0.00001)
    {
        s = 0;
        h = 0;
        return;
    }
    if(max > 0.0)
        s = delta / max;
    else
    {
        s = 0.0;
        h = NAN;
        return;
    }
    if(r >= max)
        h = (g - b) / delta;
    else if(g >= max)
        h = 2.0 + (b - r) / delta;
    else
        h = 4.0 + (r - g) / delta;

    h *= 60.0;

    if(h < 0.0)
        h += 360.0;

    h /= 360;
}

void export_tab_images_to_csv(vector<vector<uint16_t>> tab_images)
{
    unsigned int img_size = tab_images[0].size();

    ofstream file(string("images.csv").c_str());
    file << "Nb images:," << tab_images.size() << endl;
    file << "Size:," << img_size << endl;

    file << "posX,";
    for(size_t j = 0 ; j < tab_images.size() ; ++j)
        file << "Image " << j + 1 << ",,,,,,,,,,";
    file << endl;

    file << ",";
    for(size_t j = 0 ; j < tab_images.size() ; ++j)
        file << "Pattern,Red,Green,Blue,Rate Red,Rate Blue,Rate Green,Hue,Saturation,Value,";
    file << endl;

    for(unsigned int i = 0 ; i < img_size ; ++i)
    {
        file << i << ",";
        for(size_t j = 0 ; j < tab_images.size() ; ++j)
        {
            uint8_t r = extract_red(tab_images[j][i]);
            uint8_t g = extract_green(tab_images[j][i]);
            uint8_t b = extract_blue(tab_images[j][i]);
            double h, s, v;
            convert_rgb_to_hsv(h, s, v, r, g, b);
            file << tab_images[j][i] << ","
                << to_string(r)     << ","
                << to_string(g)     << ","
                << to_string(b)     << ","
                << to_string(r/31.) << ","
                << to_string(g/63.) << ","
                << to_string(b/31.) << ","
                << to_string(h)     << ","
                << to_string(s)     << ","
                << to_string(v)     << ",";
        }

        file << endl;
    }

}

// CODE VERSION 1
/*
/// DEBUT DU CODE A METTRE DANS L'E-PUCK

#define IMAGE_BUFFER_SIZE               640
#define NO_RISE_FALL_FOUND_POS          IMAGE_BUFFER_SIZE + 1
#define GREEN_PIXEL_RISE_FALL_THRESHOLD (int16_t)(0.25 * 63)
#define THRESHOLD_BALL_COLOR_IN_GREEN   13
#define TAN_45_OVER_2_CONST             0.4142135679721832275390625f // in rad, fit for float

float compute_angle_ball(uint16_t ball_middle_pos)
{
    return atan((((float)ball_middle_pos / 320) - 1) * TAN_45_OVER_2_CONST) * 180.f / M_PI;
}

void detection_in_image(uint8_t * green_pixels)
{
    uint16_t last_fall_pos = NO_RISE_FALL_FOUND_POS;
    uint16_t sum;
    int16_t pixel_derivative;

    for(uint16_t i = 2 ; i < IMAGE_BUFFER_SIZE - 2 ; ++i)
    {
        pixel_derivative = (int16_t)green_pixels[i + 2] - (int16_t)green_pixels[i - 2];
        if(last_fall_pos < IMAGE_BUFFER_SIZE)   // if the beginning of a ball has been seen, we can look at the end of a ball
        {
            sum += green_pixels[i];
            if(pixel_derivative >= GREEN_PIXEL_RISE_FALL_THRESHOLD)
            {
                if(sum < THRESHOLD_BALL_COLOR_IN_GREEN * (i - last_fall_pos))
                {
                    float ball_angle = compute_angle_ball((last_fall_pos + i) >> 1);

                    cout << "ball is located in between: " << last_fall_pos << " and " << i << endl;
                    cout << "angle is: " << ball_angle;
                    last_fall_pos = NO_RISE_FALL_FOUND_POS;
                }
            }
        }
        if(pixel_derivative <= -GREEN_PIXEL_RISE_FALL_THRESHOLD)
        {
            last_fall_pos = i;
            sum = 0;
        }
    }
}


/// FIN DU CODE
*/

/// DEBUT DU CODE

//#define MAX_VALUE_CASE                  8
#define MASK_LOOKUP_CASE_LENGTH         3
#define MASK_LOOKUP_CASE                ((1 << MASK_LOOKUP_CASE_LENGTH) - 1)
#define NB_LOOKUP_PRESENCE_CASE         (0xFFFF >> MASK_LOOKUP_CASE_LENGTH)

#define IMAGE_BUFFER_SIZE               640
#define BALL_MIN_SIZE_ACCEPT            30

static int16_t compute_angle_from_image(int16_t pos)
{
	static const int16_t precalculated_values[IMAGE_BUFFER_SIZE/2] =
		{2,		5,		7,		10,		13,		15,		18,		21,		23,		26,
		29,		31,		34,		37,		39,		42,		45,		47,		50,		53,
		55,		58,		61,		63,		66,		69,		71,		74,		77,		79,
		82,		85,		87,		90,		93,		95,		98,		101,	103,	106,
		109,	111,	114,	117,	119,	122,	125,	127,	130,	132,
		135,	138,	140,	143,	146,	148,	151,	154,	156,	159,
		162,	164,	167,	170,	172,	175,	177,	180,	183,	185,
		188,	191,	193,	196,	199,	201,	204,	207,	209,	212,
		214,	217,	220,	222,	225,	228,	230,	233,	235,	238,
		241,	243,	246,	249,	251,	254,	256,	259,	262,	264,
		267,	270,	272,	275,	277,	280,	283,	285,	288,	290,
		293,	296,	298,	301,	304,	306,	309,	311,	314,	317,
		319,	322,	324,	327,	330,	332,	335,	337,	340,	342,
		345,	348,	350,	353,	355,	358,	361,	363,	366,	368,
		371,	373,	376,	379,	381,	384,	386,	389,	391,	394,
		397,	399,	402,	404,	407,	409,	412,	415,	417,	420,
		422,	425,	427,	430,	432,	435,	437,	440,	443,	445,
		448,	450,	453,	455,	458,	460,	463,	465,	468,	470,
		473,	476,	478,	481,	483,	486,	488,	491,	493,	496,
		498,	501,	503,	506,	508,	511,	513,	516,	518,	521,
		523,	526,	528,	531,	533,	536,	538,	541,	543,	546,
		548,	551,	553,	555,	558,	560,	563,	565,	568,	570,
		573,	575,	578,	580,	583,	585,	587,	590,	592,	595,
		597,	600,	602,	605,	607,	609,	612,	614,	617,	619,
		622,	624,	626,	629,	631,	634,	636,	639,	641,	643,
		646,	648,	651,	653,	655,	658,	660,	663,	665,	667,
		670,	672,	675,	677,	679,	682,	684,	686,	689,	691,
		694,	696,	698,	701,	703,	705,	708,	710,	713,	715,
		717,	720,	722,	724,	727,	729,	731,	734,	736,	738,
		741,	743,	745,	748,	750,	752,	755,	757,	759,	762,
		764,	766,	768,	771,	773,	775,	778,	780,	782,	785,
		787,	789,	791,	794,	796,	798,	801,	803,	805,	807};

	return pos >= IMAGE_BUFFER_SIZE/2 ? -precalculated_values[pos-IMAGE_BUFFER_SIZE/2] : precalculated_values[IMAGE_BUFFER_SIZE/2-pos-1];
}

bool check_ball_presence(uint16_t pixel)
{
    uint8_t r, g, b;
    r = (pixel >> 11) & 31;
    g = (pixel >> 5) & 63;
    b = pixel & 31;

    double h,s,v;
    convert_rgb_to_hsv(h,s,v,r,g,b);

    return (s > 0.6 && (h < 0.05 || h > 0.85));
}

bool check_ball_presence_with_lookup(uint16_t pixel)
{
    static const uint8_t lookup_check_ball_presence[NB_LOOKUP_PRESENCE_CASE] = {
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   3,   0,   0,   0,   3,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   7,   0,
  0,   0,   7,   0,   0,   0,   6,   0,   0,   0,   2,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,  15,   0,   0,   0,  15,   0,   0,   0,  15,   0,   0,   0,
 14,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,  31,   0,   0,   0,  31,   0,   0,   0,
 31,   0,   0,   0,  31,   0,   0,   0,  30,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  63,   0,   0,   0,
 63,   0,   0,   0,  63,   0,   0,   0,  63,   0,   0,   0,  62,   0,
  0,   0,   6,   0,   0,   0,   4,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
127,   0,   0,   0, 127,   0,   0,   0, 127,   0,   0,   0, 127,   0,
  0,   0, 127,   0,   0,   0, 126,   0,   0,   0,   4,   0,   0,   0,
  4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0, 255,   0,   0,   0, 255,   0,   0,   0, 255,   0,
  0,   0, 255,   0,   0,   0, 255,   0,   0,   0, 254,   0,   0,   0,
254,   0,   0,   0,  12,   0,   0,   0,   8,   0,   0,   0,   8,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0, 255,   1,   0,   0, 255,   1,
  0,   0, 255,   1,   0,   0, 255,   1,   0,   0, 255,   1,   0,   0,
255,   1,   0,   0, 254,   1,   0,   0, 252,   1,   0,   0,  12,   0,
  0,   0,   8,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255,   1,
  0,   0, 255,   3,   0,   0, 255,   3,   0,   0, 255,   3,   0,   0,
255,   3,   0,   0, 255,   3,   0,   0, 255,   3,   0,   0, 254,   3,
  0,   0, 252,   3,   0,   0,   8,   0,   0,   0,   8,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0, 255,   3,   0,   0, 255,   3,   0,   0, 255,   3,   0,   0,
255,   7,   0,   0, 255,   7,   0,   0, 255,   7,   0,   0, 255,   7,
  0,   0, 254,   7,   0,   0, 254,   7,   0,   0,  28,   0,   0,   0,
 24,   0,   0,   0,  16,   0,   0,   0,  16,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0, 255,   7,   0,   0, 255,   7,   0,   0,
255,   7,   0,   0, 255,   7,   0,   0, 255,   7,   0,   0, 255,  15,
  0,   0, 255,  15,   0,   0, 255,  15,   0,   0, 254,  15,   0,   0,
252,  15,   0,   0,  28,   0,   0,   0,  24,   0,   0,   0,  16,   0,
  0,   0,  16,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255,  15,   0,   0,
255,  15,   0,   0, 255,  15,   0,   0, 255,  15,   0,   0, 255,  15,
  0,   0, 255,  15,   0,   0, 255,  15,   0,   0, 255,  31,   0,   0,
254,  31,   0,   0, 254,  31,   0,   0, 252,  31,   0,   0,  56,   0,
  0,   0,  56,   0,   0,   0,  48,   0,   0,   0,  32,   0,   0,   0,
 32,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
255,  31,   0,   0, 255,  31,   0,   0, 255,  31,   0,   0, 255,  31,
  0,   0, 255,  31,   0,   0, 255,  31,   0,   0, 255,  31,   0,   0,
255,  31,   0,   0, 255,  31,   0,   0, 254,  63,   0,   0, 252,  63,
  0,   0, 252,  63,   0,   0,  56,   0,   0,   0,  48,   0,   0,   0,
 48,   0,   0,   0,  32,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0, 255,  63,   0,   0, 255,  63,   0,   0, 255,  63,
  0,   0, 255,  63,   0,   0, 255,  63,   0,   0, 255,  63,   0,   0,
255,  63,   0,   0, 255,  63,   0,   0, 255,  63,   0,   0, 255,  63,
  0,   0, 254,  63,   0,   0, 252, 127,   0,   0, 248, 127,   0,   0,
 56,   0,   0,   0,  48,   0,   0,   0,  32,   0,   0,   0,  32,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0, 255, 127,   0,   0, 255, 127,
  0,   0, 255, 127,   0,   0, 255, 127,   0,   0, 255, 127,   0,   0,
255, 127,   0,   0, 255, 127,   0,   0, 255, 127,   0,   0, 255, 127,
  0,   0, 255, 127,   0,   0, 254, 127,   0,   0, 254, 127,   0,   0,
252, 127,   0,   0, 248, 255,   0,   0, 120,   0,   0,   0, 112,   0,
  0,   0,  96,   0,   0,   0,  64,   0,   0,   0,  64,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255,
  0,   0, 255, 255,   0,   0, 255, 255,   0,   0, 255, 255,   0,   0,
255, 255,   0,   0, 255, 255,   0,   0, 255, 255,   0,   0, 255, 255,
  0,   0, 255, 255,   0,   0, 255, 255,   0,   0, 255, 255,   0,   0,
254, 255,   0,   0, 252, 255,   0,   0, 252, 255,   0,   0, 120,   0,
  0,   0, 112,   0,   0,   0, 112,   0,   0,   0,  96,   0,   0,   0,
 64,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0, 255, 255,   1,   0, 255, 255,   1,   0, 255, 255,   1,   0,
255, 255,   1,   0, 255, 255,   1,   0, 255, 255,   1,   0, 255, 255,
  1,   0, 255, 255,   1,   0, 255, 255,   1,   0, 255, 255,   1,   0,
255, 255,   1,   0, 254, 255,   1,   0, 254, 255,   1,   0, 252, 255,
  1,   0, 248, 255,   1,   0, 248,   0,   0,   0, 240,   0,   0,   0,
224,   0,   0,   0, 224,   0,   0,   0, 192,   0,   0,   0, 128,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0, 255, 255,   3,   0, 255, 255,   3,   0,
255, 255,   3,   0, 255, 255,   3,   0, 255, 255,   3,   0, 255, 255,
  3,   0, 255, 255,   3,   0, 255, 255,   3,   0, 255, 255,   3,   0,
255, 255,   3,   0, 255, 255,   3,   0, 255, 255,   3,   0, 254, 255,
  3,   0, 254, 255,   3,   0, 252, 255,   3,   0, 248, 255,   3,   0,
240,   0,   0,   0, 240,   0,   0,   0, 224,   0,   0,   0, 192,   0,
  0,   0, 192,   0,   0,   0, 128,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255,   3,   0,
255, 255,   7,   0, 255, 255,   7,   0, 255, 255,   7,   0, 255, 255,
  7,   0, 255, 255,   7,   0, 255, 255,   7,   0, 255, 255,   7,   0,
255, 255,   7,   0, 255, 255,   7,   0, 255, 255,   7,   0, 255, 255,
  7,   0, 255, 255,   7,   0, 254, 255,   7,   0, 252, 255,   7,   0,
252, 255,   7,   0, 248, 255,   7,   0, 240,   0,   0,   0, 224,   0,
  0,   0, 224,   0,   0,   0, 192,   0,   0,   0, 128,   0,   0,   0,
128,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
255, 255,   7,   0, 255, 255,   7,   0, 255, 255,   7,   0, 255, 255,
 15,   0, 255, 255,  15,   0, 255, 255,  15,   0, 255, 255,  15,   0,
255, 255,  15,   0, 255, 255,  15,   0, 255, 255,  15,   0, 255, 255,
 15,   0, 255, 255,  15,   0, 255, 255,  15,   0, 254, 255,  15,   0,
254, 255,  15,   0, 252, 255,  15,   0, 248, 255,  15,   0, 248, 255,
 15,   0, 240,   1,   0,   0, 224,   1,   0,   0, 192,   1,   0,   0,
192,   1,   0,   0, 128,   1,   0,   0,   0,   1,   0,   0,   0,   1,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0, 255, 255,  15,   0, 255, 255,  15,   0, 255, 255,
 15,   0, 255, 255,  15,   0, 255, 255,  15,   0, 255, 255,  31,   0,
255, 255,  31,   0, 255, 255,  31,   0, 255, 255,  31,   0, 255, 255,
 31,   0, 255, 255,  31,   0, 255, 255,  31,   0, 255, 255,  31,   0,
255, 255,  31,   0, 254, 255,  31,   0, 252, 255,  31,   0, 252, 255,
 31,   0, 248, 255,  31,   0, 240,   1,   0,   0, 240,   1,   0,   0,
224,   1,   0,   0, 192,   1,   0,   0, 128,   1,   0,   0, 128,   1,
  0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0, 255, 255,  31,   0, 255, 255,
 31,   0, 255, 255,  31,   0, 255, 255,  31,   0, 255, 255,  31,   0,
255, 255,  31,   0, 255, 255,  31,   0, 255, 255,  63,   0, 255, 255,
 63,   0, 255, 255,  63,   0, 255, 255,  63,   0, 255, 255,  63,   0,
255, 255,  63,   0, 255, 255,  63,   0, 255, 255,  63,   0, 254, 255,
 63,   0, 252, 255,  63,   0, 248, 255,  63,   0, 248, 255,  63,   0,
240,   3,   0,   0, 224,   3,   0,   0, 224,   3,   0,   0, 192,   3,
  0,   0, 128,   3,   0,   0,   0,   3,   0,   0,   0,   3,   0,   0,
  0,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255,
 63,   0, 255, 255,  63,   0, 255, 255,  63,   0, 255, 255,  63,   0,
255, 255,  63,   0, 255, 255,  63,   0, 255, 255,  63,   0, 255, 255,
 63,   0, 255, 255,  63,   0, 255, 255, 127,   0, 255, 255, 127,   0,
255, 255, 127,   0, 255, 255, 127,   0, 255, 255, 127,   0, 255, 255,
127,   0, 254, 255, 127,   0, 254, 255, 127,   0, 252, 255, 127,   0,
248, 255, 127,   0, 240, 255, 127,   0, 240,   3,   0,   0, 224,   3,
  0,   0, 192,   3,   0,   0, 192,   3,   0,   0, 128,   3,   0,   0,
  0,   3,   0,   0,   0,   3,   0,   0,   0,   2,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0, 255, 255, 127,   0, 255, 255, 127,   0, 255, 255, 127,   0,
255, 255, 127,   0, 255, 255, 127,   0, 255, 255, 127,   0, 255, 255,
127,   0, 255, 255, 127,   0, 255, 255, 127,   0, 255, 255, 127,   0,
255, 255, 127,   0, 255, 255, 255,   0, 255, 255, 255,   0, 255, 255,
255,   0, 255, 255, 255,   0, 255, 255, 255,   0, 254, 255, 255,   0,
252, 255, 255,   0, 252, 255, 255,   0, 248, 255, 255,   0, 240, 255,
255,   0, 224,   3,   0,   0, 224,   3,   0,   0, 192,   3,   0,   0,
128,   3,   0,   0, 128,   3,   0,   0,   0,   3,   0,   0,   0,   2,
  0,   0,   0,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0, 255, 255, 255,   0, 255, 255, 255,   0,
255, 255, 255,   0, 255, 255, 255,   0, 255, 255, 255,   0, 255, 255,
255,   0, 255, 255, 255,   0, 255, 255, 255,   0, 255, 255, 255,   0,
255, 255, 255,   0, 255, 255, 255,   0, 255, 255, 255,   0, 255, 255,
255,   0, 255, 255, 255,   1, 255, 255, 255,   1, 255, 255, 255,   1,
254, 255, 255,   1, 254, 255, 255,   1, 252, 255, 255,   1, 248, 255,
255,   1, 248, 255, 255,   1, 240, 255, 255,   1, 224,   7,   0,   0,
192,   7,   0,   0, 192,   7,   0,   0, 128,   7,   0,   0,   0,   7,
  0,   0,   0,   7,   0,   0,   0,   6,   0,   0,   0,   4,   0,   0,
  0,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255, 255,   1,
255, 255, 255,   1, 255, 255, 255,   1, 255, 255, 255,   1, 255, 255,
255,   1, 255, 255, 255,   1, 255, 255, 255,   1, 255, 255, 255,   1,
255, 255, 255,   1, 255, 255, 255,   1, 255, 255, 255,   1, 255, 255,
255,   1, 255, 255, 255,   1, 255, 255, 255,   1, 255, 255, 255,   1,
255, 255, 255,   3, 255, 255, 255,   3, 254, 255, 255,   3, 252, 255,
255,   3, 252, 255, 255,   3, 248, 255, 255,   3, 240, 255, 255,   3,
240,   7,   0,   0, 224,   7,   0,   0, 192,   7,   0,   0, 128,   7,
  0,   0, 128,   7,   0,   0,   0,   7,   0,   0,   0,   6,   0,   0,
  0,   6,   0,   0,   0,   4,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
255, 255, 255,   3, 255, 255, 255,   3, 255, 255, 255,   3, 255, 255,
255,   3, 255, 255, 255,   3, 255, 255, 255,   3, 255, 255, 255,   3,
255, 255, 255,   3, 255, 255, 255,   3, 255, 255, 255,   3, 255, 255,
255,   3, 255, 255, 255,   3, 255, 255, 255,   3, 255, 255, 255,   3,
255, 255, 255,   3, 255, 255, 255,   3, 255, 255, 255,   3, 255, 255,
255,   7, 254, 255, 255,   7, 252, 255, 255,   7, 248, 255, 255,   7,
248, 255, 255,   7, 240, 255, 255,   7, 224,  15,   0,   0, 224,  15,
  0,   0, 192,  15,   0,   0, 128,  15,   0,   0, 128,  15,   0,   0,
  0,  15,   0,   0,   0,  14,   0,   0,   0,  12,   0,   0,   0,  12,
  0,   0,   0,   8,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0, 255, 255, 255,   7, 255, 255, 255,   7, 255, 255,
255,   7, 255, 255, 255,   7, 255, 255, 255,   7, 255, 255, 255,   7,
255, 255, 255,   7, 255, 255, 255,   7, 255, 255, 255,   7, 255, 255,
255,   7, 255, 255, 255,   7, 255, 255, 255,   7, 255, 255, 255,   7,
255, 255, 255,   7, 255, 255, 255,   7, 255, 255, 255,   7, 255, 255,
255,   7, 255, 255, 255,   7, 254, 255, 255,   7, 254, 255, 255,  15,
252, 255, 255,  15, 248, 255, 255,  15, 240, 255, 255,  15, 240, 255,
255,  15, 224,  15,   0,   0, 192,  15,   0,   0, 192,  15,   0,   0,
128,  15,   0,   0,   0,  15,   0,   0,   0,  15,   0,   0,   0,  14,
  0,   0,   0,  12,   0,   0,   0,   8,   0,   0,   0,   8,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0, 255, 255, 255,   7, 255, 255,
255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  15,
255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255,
255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  15,
255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255,
255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  15,
254, 255, 255,  15, 252, 255, 255,  15, 252, 255, 255,  31, 248, 255,
255,  31, 240, 255, 255,  31, 224, 255, 255,  31, 224,  15,   0,   0,
192,  15,   0,   0, 128,  15,   0,   0, 128,  15,   0,   0,   0,  15,
  0,   0,   0,  14,   0,   0,   0,  14,   0,   0,   0,  12,   0,   0,
  0,   8,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255,
255,  15, 255, 255, 255,  15, 255, 255, 255,  15, 255, 255, 255,  31,
255, 255, 255,  31, 255, 255, 255,  31, 255, 255, 255,  31, 255, 255,
255,  31, 255, 255, 255,  31, 255, 255, 255,  31, 255, 255, 255,  31,
255, 255, 255,  31, 255, 255, 255,  31, 255, 255, 255,  31, 255, 255,
255,  31, 255, 255, 255,  31, 255, 255, 255,  31, 255, 255, 255,  31,
255, 255, 255,  31, 254, 255, 255,  31, 254, 255, 255,  31, 252, 255,
255,  31, 248, 255, 255,  31, 248, 255, 255,  63, 240, 255, 255,  63,
224, 255, 255,  63, 224,  31,   0,   0, 192,  31,   0,   0, 128,  31,
  0,   0,   0,  31,   0,   0,   0,  31,   0,   0,   0,  30,   0,   0,
  0,  28,   0,   0,   0,  28,   0,   0,   0,  24,   0,   0,   0,  16,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
  0};
    return ((lookup_check_ball_presence[pixel >> MASK_LOOKUP_CASE_LENGTH] & (1 << (pixel & MASK_LOOKUP_CASE))) != 0);
}

void detection_in_image(uint16_t * pixels)
{
    bool last_fall_found = false;
    int16_t last_fall_angle;

    uint16_t continuity_start;
    for(uint16_t i = 0 ; i < IMAGE_BUFFER_SIZE ; ++i)
    {
        //cout << "pixel: " << pixels[i] << endl;
        //cout << check_ball_presence_with_lookup(pixels[i]) << " " << check_ball_presence(pixels[i]) << endl;
        assert(check_ball_presence_with_lookup(pixels[i]) == check_ball_presence(pixels[i]));
        if(check_ball_presence_with_lookup(pixels[i]))
        {
            if(!last_fall_found)
            {
                last_fall_found = true;
                continuity_start = i;
                last_fall_angle = compute_angle_from_image(i);
            }
        }
        else if(last_fall_found)
        {
            if(i - continuity_start > BALL_MIN_SIZE_ACCEPT)
            {
                cout << "angle is: " << (compute_angle_from_image(i) + last_fall_angle)/2 << endl;
            }
            // resets and so...
            last_fall_found = false;
        }
    }
}

/// FIN DU CODE

void launch_detection_in_image(vector<uint16_t> & image)
{
    assert(image.size() == IMAGE_BUFFER_SIZE);
    uint8_t red_pixels[IMAGE_BUFFER_SIZE] = {0};
    uint8_t green_pixels[IMAGE_BUFFER_SIZE] = {0};
    uint8_t blue_pixels[IMAGE_BUFFER_SIZE] = {0};
    uint16_t pixels[IMAGE_BUFFER_SIZE] = {0};

    for(size_t i = 0 ; i < image.size() ; ++i)
    {
        red_pixels[i] = extract_red(image[i]);
        green_pixels[i] = extract_green(image[i]);
        blue_pixels[i] = extract_blue(image[i]);
        pixels[i] = image[i];
    }

    detection_in_image(pixels);
}

int main()
{
    vector<vector<uint16_t>> tab_images = extract_tab_images("diverses images de fond.txt");
    export_tab_images_to_csv(tab_images);

    for(size_t i = 0 ; i < tab_images.size() ; ++i)
        launch_detection_in_image(tab_images[i]);


    return 0;
}
